// SPDX-License-Identifier: AGPL-3.0
pragma solidity ^0.8.13;

import "forge-std/Test.sol";
import "../src/sealed-bid/sneaky-auction/LibBalanceProof.sol";

contract BalanceProofWrapper is Test {
    function getProvenAccountBalance(
        bytes[] memory proof,
        bytes memory blockHeaderRLP,
        bytes32 blockHash,
        address account
    ) 
        external
        returns (uint256 accountBalance)
    {
        uint256 gasBefore = gasleft();
        accountBalance = LibBalanceProof.getProvenAccountBalance(
            proof,
            blockHeaderRLP,
            blockHash, 
            account
        );
        emit log_named_uint("getProvenAccountBalance gas", gasBefore - gasleft());
    }
}

contract BalanceProofTest is Test {
    BalanceProofWrapper wrapper;

    function setUp() external {
        wrapper = new BalanceProofWrapper();
    }

    function testBalanceProof1() external {
        bytes[] memory accountStateProof = new bytes[](8);
        accountStateProof[0] = hex"f90211a0cc69188b2bd649b668c93360fe755bbe8168858799dbe67e8060daec3afabc63a0671fe6acefa38a5a5649a034cfd6e5528576935668c59ef423829f28fcf694b7a0d7b2a0999fe95658835924a53765d0ab02e97150768077661391d1681010361ba05868edf8210379b230dde8106abae4c865463fce5d7a49f1bd3e31ff4a697ec5a03dbb7990607ef1e5d803f9a067f1ec0460bda27968ac25dfef05f50e56b77361a0a67e2c0ae1f9ce984a5b3d9e3372329aa79125c86658fa412c917d50eb2774c4a0144b8374a8246155c3f3f93eed4576bafeb54baf413a355a18fd249611de5df4a0e1291a1855a3b620f3fd4d218f6658c6f5b9d6fa7fd035ef6aa872c530975c5ba08b1d1f2e95c2b801361b21c7f6424984fce5446f56702b65a4a1ececc687c07ea0300b1479afdcfb73aac6cb3c510d56a6187800f4fbfec4b6581b302c329d9364a0234fe2d73fd34d4e545e57f2a1df4289d0a549ac32eea498289c467873b17f63a084f1f004285716fbdd2c3a68ce7b645eb760d2d46224c099a8220d63696e5064a0d858bb71b0aebf4b326c274ee9075109ca0ebabc31ee009f8fd98ff5c1aa3040a065713e099110b21c5a4f3d154338e7d5bf29bbdf4252728b2213211ed8e10684a0593a458c370746048a1b786d072b64fa4240d29a9bc9964ac34e600dfde02ba1a0b5cefc3890a83c1dff8ebe71d4a957dece75216fffdfb55d24516893851b19b880";
        accountStateProof[1] = hex"f90211a0446fae619d121ac3d26c08d3bb0bb50a196c99f3556c71c7ef260a478a5efe84a084c6a45408acab21b552a157d0ceab2c01ef2cfc227a37d466626b181f39adeda0064bdd7b64dc5790bdd3a765f2aa09118e7ab8eb3a58570623b607ceaa77668aa0087689f697aad266b60801f7f3153ff1d9e71057ab68b45c8f7e157473c7407ca0d8f57db40d44c7c66748f51c09f189310e1d211353c6403d2a65e9b07c89f0eaa052c82b384e2cf62ac6b24ddf61fd3535fa25e646dfd5b9b33ffb9e9d9c5cdddba08203d0a1029caa8f5bb183818b7a5c59746a95dd2cd73e643a12eff8c399d057a0640b88f89f20c2277dc7ace13914dd3b1bea0406456dc84daa9936206f38a75fa0c6bbb6e38896f69bf11e151091e5230d355b3b86c3205257c3b5eb653ba4246ba095156774be3065d80b051ae55d857eb69a82feefb3a1c68af4e7243ef8beb5c2a0da9b90547a12ea74816bd312acf491ccc2f3b32b2f2546a5f54fb2a79e0c13b8a030327cdc767e7a6ea4be88d1203c8ca3d6352bdc782788237a9355dd44be38aba03adbd6f74c7f4e8e40965a01e22e5d989dc443d4220abc9f45bcf62c60b072a3a0695bfe0614c018ac7c8cac305bcbcb9718e53e63a1bf70372aad85685999cdf6a014eccdbfa5ccbb217b154ba1699f231d412afeab34902d7f85504c9a9da10ef6a010b85343c6c39ccca3bfa9f06004189cc14a83cb66deb73ca64130b064cb693a80";
        accountStateProof[2] = hex"f90211a0d2ecd51a0a6a423cb4ea02398e984b0592628fabec7ea2a37db3b585569420f1a042f0031992bc55bcc1453b5d868a5124ce3b6d4aeec343c4d6cfbfcedc991696a0e39c54f7c4ee4b8cbee85f0859ef337b0140f23418bab07292be913c02ff627ba0b8391d580df0bebf46aa0bed830d0435f15415d07e90726104519557510f2d40a08f3013910d1944829eacbe008704451a33adea5ac616771befeb3839c01e7f84a03e27c3c454652980c9c629bb49e4132df2347382223ac0b1c2f6ff6934d93a5fa0218f8d01a69d2743e5e25a74f7740adac1e422fc4de19bcc7f32b432bdb1a7c5a056f51387510a6c2df379cbc9bc96f1ec2ad0a90dec917fd098171fe09fa7f9aaa028b3dac300b75e0cadf44692cd84fe9444fc4f58574e72a10ced32479ff57f09a041fe15b4a179b9005e2d57b03916bb986275032d28a931774e9a8de1ad2ae09aa0a7f563ea2c99293c6691787df9034bc61b4005ac8c017a8cdba70ca807aa5901a048bdc2cfe33f93f8e8a0496e2b700d8a0304e6cd6b5c50c727a77a47dd83a8f7a0a1fae86dc1ea7babf0d81c9801bc632b8ae62036bc718fb4508c5fd9d1f34033a074dd3d43a4f4f5cd9e2032c6fe9fa927faa05be34fb47b3d70637ca22f1aec72a05de9a7d754d3001725f362e2e56464b8f31e8729e06d366f3b4f2ba0619554c4a01d707a3d126c29eb9ea597e5333f49ba20d8a62880bf237312219086e5c9385080";
        accountStateProof[3] = hex"f90211a0c19c7dbb7ce084ed5eed373ad65584ccf4e19f50d7dcdc2211f315915512d116a0d601a50d9c4ec56e4534921426ded5e861cea7b40772cb3d6a6701c8dc462356a0b0fc2891acd8c6a87eee72e6ccb78638b004bda0fc85dc43e51a2da1f4de17b1a052ebb6ae12547235a1889f366e9989d432f6e199b64e8629136f4f08a64bbb7ea0078d47b5e3213e7c641d44467d369611ebfa9310765ab2eb43a71bfdb51a52eba04fed0655ae946aff6c0a8289e747c65e71833cd2f45d99e5180ac738cc9d1f01a02f2e257850c35e65d6c3cf081383e5403a5dfcae9024a5d896790fd8804a3f7aa07139e7b3de31218fc23b6a83adde099571351c3f5208c1eec30d26f2f30a9ec2a0cfbf071577414cf2e9fd9a6f87fd728aaf5caa349966bfe9e37950c53bc3cccda0ea3702c90c69733b735bd43f7e2e1f6f4062a172a65e0af54f4a77fe6f102396a089ae768a8b6b11aa6c046ab3863608e030cd3a08063ddc617e2ce0569a91e02ca04d270cd6d2d82b13e53fdf1ac884731da4dc0a7417ff64e4bf0e7433505506dba060acb0b276d371263b025ea2db59017234ca302326b9135cf81196748e7c83d4a0863627f17f1bc442c75e7f8181ac53c0f45310d20155ced1b82e71ddc7b8a918a0d48fa0c3e856018f90349ac934a325a87e995eb0dbd585dbeb2c2ef44d7527a5a0456f16982dd51005c4f601639f90d44509f459ba729e786f6637ec09f1cbbd5c80";
        accountStateProof[4] = hex"f90211a0878f722acc6458e3328700be413e120ba14297b6564fe66502470dcd69cbeecca09bc19dcb326ad70bda8a41d1c3b3457419100ddbd8c41ccc56096f0699d176d2a0481ca07f546a9fb7fe447bf695a8c180a03de017c2ff981db283ccbd18800c89a0f25dd5b4a2c7499c7da4a193880f7a37e4aec64640f20ec55f2e09b9e4dcb532a0d3039ccdb8c82b23775ff516e6ec04cdbb151a7c73c172f02f3861c39eee1011a0e5af74385328c9274d5d794ae3f55c60b62813d56a7317d49cde16df59983fa4a0f59ec6922734f3c6597cc64bdd1ffe346fcabe060dd056ae9684c874fbeeb107a04483389972423a3d818ba7c3aed4676c02f93f92358fc8189d0188e41398f1f9a06dc5d16c7461b8b58f1b37b6816901b30d23175da590bcd10c4cd9f45af77ab8a0b7d533dc2d442ab34edcdc0e23219d9eadc95fe594604a6effac7e6570ae4ec9a0ab27ea836c563d3f359603107d47dfa18c30bee11bec82f06eac7eb87429079ca070da8480b0ef92ab12879123cd1e0317f55ddb5c31ab856a59e6d7c31e19d7f6a02299fbda1340ca4ef4ed028f4472edc0bbc3291caac17021d0d34ca5bea7edc9a0c66bdf9446f067f70c95f1e9a2c3dc54843f10eaa8e7d920743e9ae3d9fab6c6a02ec8aa48cda8cbe9f20bbac62fe4551e5ee66503962651641f8f7ff1ec566404a0db2e1b67e9e9dd8b278d649c3ae3a45b5d0711da064b96c17dd003db96c9dcee80";
        accountStateProof[5] = hex"f90211a0039dc66b6ca7ab4b7cd3e8993da8f55225e2d7a8fd88f9d83a0df3a769dfae26a0e9f58d8c32a868fe97b71563b0b9f8b20c6461d0dac568edcec8dc5950fe17b2a0285908fb0e410a232fd829a6eb7c51d418ab103004a1e8c6dbbe146358c005dca0a3db7fd870080981ab1288bd23bff5b9740c4bcf0bae0a976aeab01823344d9fa02f8d64a6ccca8d688590733a3a70bc170e26b1d181180d2d8e7445a2f8231d24a03f603e70e5eecd17c4a041ecb4efb0dde1ba25eb07b93c6ef3392914dfea3ac9a070b956b347ff9714904c289d6fc5c62cafc86c7483a1fc06e8a78400a6a264aba0535ab8730a26fb7dff05d184de62c7c8d235888be271e519d8e14f03d11e01bfa0ed73daedfe28ad20ab6bfc61627c0f2aeaddcaf1c12396739f27e949ed9378c5a0bf1737a12ac46792da05d261c18cf1ac42eaf737bc841bd94bbb34f822e858aca0fee47037aa5bc644457a8e61b2b342a734e9a823791eba9a28356bb0d26edd20a0394f6d632bcbb205323042785f2ebffab1d9e96772e7a69ed1274b1e0c10c7a4a04a6becdf349ca4c5a6a022b1a01a394f6b46410d0906f1dfe567f2f3ac01bb9aa0f2d648af39701b648afe20b07d12c684a29517ecaf0881045cec0e451f2ddcd1a072a68b3e41e8cbbb2ec558e53d9beee7cbe71cb863251f5dbc0453062ac107aca01dde9f002d3538282eb6c69c4e1d5a8ca3b927363e798dc4fa8c8efdca745ef580";
        accountStateProof[6] = hex"f901118080a02f1545bfaf20538e5b7702fe5ce6eeb5612bbf631381fca4e5bb22d484f3c2b480808080a03a14c1bbdeb172503a275b55cadb22ab91015729a314d83a2702bf9204ab6a0f80a0acd3d3380940b5ce916e8ab4337f7270e3028bb347d38d6a4e6bf3682b13bf6ca03a2664aabfde60fd56e3ad726975c637dedc74ed7208a7ff35b5fd657bfed4bda0c4f04345049576c99dd9d3af7530bab5c5ec4648760de72a3055b0b5b29b3a14a0b9f493230763cb3337e2c99e6f11fda2a73f9b97cbd4cffe2e5861877fa40442a04c0700ab405afa5aee31eb7624b5f311fc4bfd4c4f08161e809d09943ab6ea4480a04a466ac38103de49d65082da1aa2857a9ba23591189c11683c72528074c57d8980";
        accountStateProof[7] = hex"f86f9d3e4110829760b45736801d52c03d447f9fe7844c4de02e0090495f8ba2b84ff84d05892087ec91b544bdbef3a056e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470";

        bytes memory blockHeaderRLP = hex"f9021ca01bfec338f3e7357c5393fbab7f23c54344a713154fdd33fc28cc1bc38b9f093ca01dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347942daa35962a6d43eb54c48367b33d0b379c930e5ea08fcee5a104cea695f098814542cea58404ef50cdd74c40d9245bb7f03e2743f7a05204dcba7b3116d9db0d5847ad3bd68378d579bb6652ece731aa8e5392d6a759a08ee4ae9caeddb06e38e51d05b291d9b7eaa9fa25cd9be1afe1f18a90d8fd65a2b90100dfe2e953efecd3b0fbb868d2b4834b7f76c4bf52fd8f27c66889f0f9f5b2391ffffd3b6f7f99b711efcc5e4c5dff93dfff9a950cff46edbef6f3cadbb8efbbdf10e3dcbfcecc56eaaf577eff33f97aeb473a34fcfdcdfbdf2e341c7bd9ffc993b7c27035aefaabaa7dd8f7f84821f9d9e674f8577abbbc5373ec05dabf4ee76f6f37696aa34fdd7dd6cf557fef7eeac6007dfec9fdf7a76bae7f176effbfbd6eafef7353fa3beafd7d79f9d7dd3abd10ffe92ad55fab9df77b7fc63cf7bbe9cff771b602cdfd68f719845577efdf527445f72bf6862bc3ffd9a3ff7e16faf43f39f1edaf2e109f505e85ded807f31fa465c0fc1beadbbd7bb1fd0b73790273f5872afcfaec145caa83e8d7608401c951118401c931d48462e85ac893706f6f6c696e2e636f6d21a3b5669ca5f473d9a0ee7171f026c64d0345692f025b76e7a2bc88fe6a1ea015eca7cbe9e123a21f7588fda1dc89e78c74e38502f2e8a134";
        
        uint256 bal = wrapper.getProvenAccountBalance(
            accountStateProof,
            blockHeaderRLP,
            0xd781aba6b629ae62d636860df0ce0fb4604e687fa50ea3703cf31a08cccec403,
            0x3B766CD27719c2e8e7C032fB0D0DC32d23f14Af6
        );
        assertEq(bal, 600090173856058031859);
    }

    function testBalanceProof2() external {
        bytes[] memory accountStateProof = new bytes[](8);
        accountStateProof[0] = hex"f90211a0cf6ca9a67e2e86d0d48458b91bb8d49eaafbc15bfab91aee5ac0f23269e39382a099137cf04fb915a6f8c7f2ab9860e59e6a609098085f69581db2c7c7786b7b10a0d0b8fa9dc773e1c2e116d2ba6f72883e532f0d63a8b620e06e1c1db15e52c663a07104025ed28bb02d0af99aee18dd6b38fa20306359d9e6666dc4697167631ae4a0ec24883d99b82931060341e220f41a8c31faa394c93486c7fe0837a0990976b9a06df241a1a9de5dcccfe1254804d470c187fc8c9ba2c8af48d2de57473cb2f715a0744990f0f9e5127c771ada6c12aba6dc961d39bea3e7bf27fd3447d9f8a846aea00fd8a52d5e695f849034f3466ba168a09d1b07ec150ec85fadc348b9c5676166a0262261b3d908fb45b19dd4952399b26c1a39d78379ca79fba875de166915dd33a0236f2a4c21974e3995fbd101823a8ab1d316a189a1d339683f8d44290479fee2a021f3c73ce7d58e30e6f4fc3f48c31e1795d793340912dd46268b9d8a1a3860cca0968bd88d4b4c72612e2089ba5c12a6a91546b1b10d3756ef0d288186fe4b6acfa0e388667a976d77a16fd16d45082960ac7ec4327d2a027484a2c584f44c2f7f0ca0a811b95ce7dfe6612e818e70d00c9066b6d7feba6ba3fd99482385e8b07bca12a0cbad369712c1718b6756263155d22110422cd426d90b0603816d16fd28cf511fa00b61999a4ef2523eed16a09229866ee7b2684f3f692e7436595291c2cfe1dfc180";
        accountStateProof[1] = hex"f90211a0167ef438b2b76b15bcc498670c752eaf4846464906f292710e4e9c7d80b05313a09f0d331f77c6797a894b0a3d262211c4078dc960c87489621144aaecd585c79ea0d53d68e619c2941f16e8fd49eb6eb77c32012c55caac0a112f4d19a3b036f765a089b4eb4ec4e33879329b6e384d40371bc21e78ff049d8d2257ce4d92529e7038a0f6d600bca7399be96ab30f570193f73572e05274ee254db3085d3f34028133fda0142ee8f00a3275c7c5aced697c3f857df50a6b07a8cf05b9d40ab16d388a2c61a02c203583e26fcd93b6ca57d99dc49df98d8560809aaf73efa8a4bb391ac46026a0fff2e6dc1d3380d7d312b2c3f17240ed7b874f11f85b7624c64d1d093d10707fa0d74b084e15fac4090ecb13c9108217868fd5a39346fdcd91e725e25b5c23131ba0503b93f97ba67b5d560cab7fabd12c881a0684ceb0ffebc5df2f3471c22397cba0b8bc23450453b0fefaef54d4ddc107158e338c68a3c69e65db8c0a8d0b6d00e2a0e712a47fdd0a831210a64e7f76a8b436491d74ff8428b9bc3af95fd52cefc642a06bff132c3082978a7b239cbc62be4fda1149c26f9bc52feefa7b28116475144ea055d6bb313ae5bad02f189ddc1dd5bdb08d7a14aeebbb6c3fafac61916b467741a087d2766a8fdb24515ab26fa5fc6546d602fd453f73f1c14aa184e50b36445701a0e29f5bb9b8ff9d7949f15dcbe68a2fcc6fdd5a2f9065d148378ab20f28893bd380";
        accountStateProof[2] = hex"f90211a02cb109f286d15d261abba11295e36d89a8da3d7c9531731c6ff3fe9422af3b65a0adb4b9e698c1d130952f93d4864314ab12e2b03ea0fb59cf6c2973d6c86b05bba065c31a2d794b6d533607cd8561f3e0f4f800b74e6936ab25b592f41dcec81f3ca078bcb3bcd5762ced5d1f93fcd7e35009c5c387adb4d946ca47f9dcb262290b71a099b771f3017ade8ea9cb9e4ec6993df39e396fbb357872de917bc6f418118ac6a0497da177cfb6f39281d1f3f81b998f9e7445fdcfbb50ef52913db86f9107bae6a02462c6d5b7b943f3cb369dffb1c59efde92ba2bd125bc28ec64ad73e3698efb5a0da9f6dbc0c9f034217aac7913acdbe3bf29233691fd75d3d7e179d1f81b60bf5a0bf55694a0eaa64dc796cc1727aec329775b86889b769a0432b63dbed232e980ba087d9758dc460d51bb373f491b3e48c57905b4b40941681991560a93668a1fd2fa0870fc576df0cc69e849272ff99b955e0f75b8faae614bf49e55c7682620ff522a066076ae7e6621e4cebf0b0664423621ef4635abed7341fa609c9eba6f0cb0bfaa05bbc0482a4428c0cc71489f0fd912aedec4a22bf83008444c3830bb17b422411a01c3ba566b9be5241f4a8d9b367a4226c00052efb907081c885b6e2e458919ec3a0031779a153905ff6ac14168a5c2ebe6cabd41b0276c11a0f74342a6c5523489aa0aa5a90d8ed4af82ecc3299c43e1b19700c7b3c5c3dfdd2f1eb36bdfaef0007c480";
        accountStateProof[3] = hex"f90211a00d1587874507cf2bc60395360f57d7cfe417d5fd1b378084c7f13244c8ea1c74a0ea2e1c1e6528a4215beeb051a7ce4e5ea32f314dedaae048264aff4d927a5dd3a01ee9cb5fa35cdc215a4541e7c7e0f5da7bd3acc24eee1d27bd0298f3a8e36bcca04c67a2754c07777f7b73c43082ddf2d952286ed6a0a5518e1deb4adba52cca1fa0a95ea8280faf34e5f74b76ce8cd2374c21a687756ea30d9b153f21ffca6ae10ca0bd7da0982facd5afd869f62e85cd93838ff019c2c8e6e7f093e2935f4f970c09a0f424f930e140732397e03257761ddc0910c7abfb4970d5d34eedc4d50224097fa0a6c0554a331fe06f664f5ffdf97ae692bb3db162764642398482cea97de218a2a0fd6644cc3f90c5663ef9da37e1518cac1b0fb605fb9ee4826be8d8a18d6189e6a059caf21198b5322438ecb588a696b6c7a761653d489f4d435e30fd6f0cbe0540a0a746a427dc25382b5f46e4a7b8176d2ef80811678b0cdc626aeed1933332db01a0438f5547740b452136142c86e48b7c66e32ec8a1ac3ce7b57f81a0cd0f6288a7a0a6457cabb04c822f6138fddd248c002d8628425cf5dc99144ae7ed96b1cf9434a07e27a2fdd28b67b5b7e8ea5b0f8e1701dd1beed6a446eb6ad70b7772c2a630a4a010b2ef978b11f7a8f8649537a35be478c38736d9f0bc5228d7af5eb029fc5ac9a0a13e27353e2a46c98ac640949d5e8c86d4d171aeeccbf2483e443caeea9f9d0080";
        accountStateProof[4] = hex"f90211a011d70ecb45308e6f527acf1452239b84daafb05746111540b79550c51ef8b657a04fc104fc23f7fda47b795f2bdb1a7d31e022035b4d4b6a994a2583557c259319a0060562e84266963a816833827acbb5802803b6cf1fb21a1756cbdc6b9ff2ff66a0ca46531e0ebde39cc06764a3d16bb85239c28105e5a4a7c316654fe789e53207a063b5902578b422b25128d2402827783db3f02daebf2caee5084fa914db90e340a0d2300bb6beacd881e93708d35928f2bb1c1c8f72a7c1ab5d00601d6b3d69bf4ba0535e904447f8086e3c06271451b81a63ce2b78a4857e866b096e1810c2cf6ee4a018f927811d568131cd070498528a6c7c043034e1d3b57cf952db7c0fb8e18298a05e2fd3a1cb9ff410b98908e3ecbde5409d073ed20900c0d664de482f56b5d6faa0643de85ae0db9d85ea81cd6845059f923ba154533f40a9307dd7d4ec77ff3e49a07401923b6adba8e4941369837aea006bcc5b2bb984f65c488e79e029fe0b315da079efa3ab9c7c05e402adb9de85b9c2412e091d10a4647169a420d47f57347e3ba0015b39078321e5b7c13900a29b3cfe4ca373033cd5710d2007a297ebcaecace7a0f5b357c667bce4831a0cc1f529bb6adccb23b4f79fe5a2d56f2886f90c98448fa0c09fbec9f2d771b89a68c9f0319e6d777ab3d9ee3822df87e9bebf34a2256c98a0d16bf644037f407f25977f3381aeebac4e358328bd10665c6449ead72d550e0e80";
        accountStateProof[5] = hex"f90211a0a08f873da12eebf6f38921b45bc0995bcc4850b672515d345da3146f69eae982a0af252f90e3361b2e59fc244f76bc1243049d6d5f6441424f0bf4181a189ff023a0191091ee972447f5d6345b37d74cc5988434656142f1e028d744d66cb3149241a0379f09338f87877867325cd68586aa5ef4f326afe325e02e400c4f23f2e55a08a0c754993867d6db630fa7d8bbd2f97b1e95e889795d5f80171190bbd21bfc0dc0a03a370d5c79b07cc0a7b2ea867e112646ea54f8efeb78d9e625ad2394ea1b399da0a81ce591f12a8bcfddddb975a6a8b9b7e3d2031d9696d46cbddc71a3dfc57609a00cf1e7f7629f40099754519add43712c059153d7d542034ce06a50e4940e64b3a049d175466eb4243d581859a95564db776adcb841fdd315e9ac32224318ee6aaca05ff62f096829dd9cd0cb96a4e5fa57977e981a5fe7f6390a60eb99555b0b61b7a042ebd31321210ba7e6b0e796fa044d4da8d540c3a59e209d111587780841f57aa0861765f5203a1c61fd56ef9cf176301151fd3f7d0ff8288a38fd30542b5c600aa0e172eb763f3d78f6d11b93c17810c471f5b0f4e535ce320e8cb2c43c763d6312a0258e711ac453cf5cdf3480d8779261598bebe53a4ef63f0d930bbd7bbfd0d157a0089e78267e34e6371163cc2712e70c0ce3dbfe7dba8152f53d3996c7f5cb8cd8a0689898b3f0a1a317226bdc0d2a2935e58d90f7190e3a5e14c602311f275a253b80";
        accountStateProof[6] = hex"f9013180a0f9231c08114590ac480ba5c8067a8cbcf69cb8b6961c79dc718ee1979c6f8119a0f799e50ca1ffd60446667644ea032b61c47b3aecfbe47b7b33f076d204627dfd8080a0ce7189a0d996370396295a5a908502af390b144283d0e3667492a72d3a45a4c980a04496d738dfe3c1224848da0f6fa03cce07aaa6f28da17da37a9206bbec3b018d8080a06bf17eeffb02d057d8288ed8bb1ce19fc49bee3311ef2a1e4e41564b53ef1dd5a034763038b7b60eda233d0731bb071005ca0a7167357d3d3dbbf9f7294772da35a0a44813e5d227314100a712c8890cb9d8d51c55d1c0dcb9c68823976380f9c69d80a0dbaec85135d6f83c272bb96cdd41bec8ed489244246eab2fd06c96e75a16a09ca047420699172fc02610189a35a37881744f57071ed1b3509c300c10182eca428d80";
        accountStateProof[7] = hex"f86f9d3f087e4dca183d74713cffdf6ee5dfb61df64edce2229b183761341035b84ff84d808926b4bd9110dce80000a056e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470";
        
        bytes memory blockHeaderRLP = hex"f9021ba0d7b6f6d21970cafd1b46e59448ae4b1eeef032d15e3dcf54da302246c0a31253a01dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d4934794829bd824b016326a401d083b33d092293333a830a05421c42bdef5188363d8109a6910ff9485cef23e8b06d48ce73d7d07260f2990a0821ceeae15ba2e658b004cef7b5673f5f1e622f162110ab498be999236a8251ba0688057f1b0d6de3be3fd1840f8064ef48aa34bfce68d55c01be108cd6b8a150ab90100ceb39528e5c9cbc69db82fb88159fbbf996a64e7ed7750313a9350599e01b879f767d34379c064e943291a49ecdaf53b7ef495f93b96fdd0abbda421f53f69ca984774ed50492f7ff9674aaf5df560e124bfb183c7643064bc2bbe25ea903ca7daaf87218f2ed86fd5ce9ac5bc7639c3297d3edd50fd6efc5218659ac96bc5d837e6ad261afa396506c9017297d72e2eed2324f953439cda35637568499382a2cbd509ff18826d7d9c91e8c415d7263e7d748e1fc68c9feeaf6f76acd5efad75c3399ef6ae014b4773940737ea3c576fac75f66d75bb67d8ff281b9ee9f867e62bbffff9504bb4344d8ed2e37bd70fc0e441a70162ed11f99de84e3d40e8b46b872ae37ec21cafd883e8d7778401c9c364840192a7468462e85c3492e4b883e5bda9e7a59ee4bb99e9b1bc4a1221a04d0a95c549c9837c55d2eb3a9ca3634e374c7a4996927f6f6ad33c3316fd632288e7be8b92a4b339ad8505a6c9bb32";

        uint256 bal = wrapper.getProvenAccountBalance(
            accountStateProof,
            blockHeaderRLP,
            0x65dfbf0a9ceae816887843a43d875487f87525b7d466fff329777fc803de587c,
            0xC9D76446d5AadfF80B68B91b08CD9bc8f5551AC1
        );
        assertEq(bal, 714000000000000000000);
    }

    function testBalanceProof3() external {
        bytes[] memory accountStateProof = new bytes[](8);
        accountStateProof[0] = hex"f90211a0ad521e1f822b86a3e486a4cf50fca45d60986dabdd7f1be1e1c202fb23c19baba00f0791c5d56028b0784f427bb2a753f80d73ff1f2bdfcdf19ccfa7d83fcc49dca0283bee2747dcd4be6060b52a847e4df79ed99022eb7bb3fb0fbe4032e2b89453a000daadc37e4423a38696f59a37c0a99ab8e2e90f870a92e742cb7297002568f1a0d17d41d107e6996706e398cd24d93b3d3888c3e85976d845f113717862f7b09da040eafcf34ee87917baa65a29281be2ee726dce6d2633b5585e2485babbafe1b3a0ff13ac8c08117c630effcb53da88ee473bc6ed6f816ad8a2613c80a031856069a0680382add02cc006ce58ae10ab83d5fa4a75e02785d16f4aab4f8167e8703a01a0d1c19605288a8f873849d63bd811d557142d6ef395431ae2796c850524752d66a005b8e19188142605119b2f439737aceb639994cff8eefb67334948a6b1814033a0cb4f45a185d6bc403849989c3be74a91002a7672ae6215686aee9bbdfc4e174da0330c3529e17fae7ec02d8a416bb3d6a5a062e8675079b9a46138d3e6bb670b9ea0bd3ec0216e560447ed26a7f70680329d4684489527e485ed1d2c8d254bc39dbaa050e96adf0ed5f61351a2d73de04be367f55c46c9052c3d0ee4cb1fa237ac0c6fa05e7272027a5260fe065f92141d58bbf5a72ac8c8318e6789fc7ca82abec2e395a0f0d9b19ca6e6d54658a7274310f81a59100ebfedc595f28208f2836e45a7129880";
        accountStateProof[1] = hex"f90211a070d1235ca1dcccbed94ee1fee1981f6c33d232f36ed74c78b432f7437a01589ea0a5b029e23fe55b06a77fd05afe8b1e184017ee1f00d1c324c6d55334c6b036b1a0644b9fcc58cdcc3e8ca5714401f9cf8312614bf02d4f50d6d9963ae459d696d3a04860ea2ba370cac2970d38a721f3902de7a5891af5a7ac9212ba97e216adb67da0b3620b1c803134bc0c9d68600ed33269ad3ef24c45bec5f2a3275d70b12d7276a05c6eeaa93ca8e425257fcd15685454fef811d13c165d61679d8b1fc77a9374d5a09469c434e1516fe09b3bc1eed9ca5357f56d4e7d3c9fcea1de1d4106200ac604a0fb7e3170dc4d64c5fe803c443f28191090977d4e8b0e9cdd759d742fea57d18aa056c9e248af6767c2f4408e78652abeabd246e54ad301bde2b31b612ffed07e52a08ba55f8e69ca6355dad818af1a7afb60c8ba1cc64fb98ba68782255f5b7cc5cea024e797a102001f19847d55a55718193ace4b3077a195b170b213e5337cb225bba0131acd05426363b7412571a561aff7a643a734849b774bb397680220f5ae61f3a0a3536eb466b17da8fd62ca309a7b5afa5193a05af222bbd1d38ca4072619c296a0dcea69bf6ab94cd52a2a83a47df4dcd07c63f04dfd7333f5ce106efed0da6f40a0389eb53e569bb24372d095984c63182bcce6f07eb2e5a4350a4bec925fa3adc8a0f40e22e2a4d69b62378bd2a7fe80af01a15506394ce66efc336172d790ca364480";
        accountStateProof[2] = hex"f90211a062933e0992a016b65b9382dcc1e386be1a4a3573d8ebcd8db100feb5aa2bd888a06652a71ff2eb5809ca8c9a5e21b74552ad73fe157216535ecc601ea4ae1599c2a00c870612f081f1de9f75601802b3b3d8be69f795793614f2ed8024e27b5a28b2a063454be7c71e007371c286f3f986327e8f2564d4cd68716dac6ef2ad012a3736a0ed1752543a22e31124ec29e7f441cd05e88da29eb8f2b6baadd01bddc8d39cf4a03c726782cd4fd7649b6932cee2fb717fcbcbfef353b8f83c6f6f6b7c7dc480d2a082d25af4e38b66c10610c47ffdfb2db7a780047629ffb42a71f5cb2e76d85f74a025aaa2b298c7fdc31b5cb30d709ca68a06b32af7ec239e53181a0b09a86e1e23a07bc273de4ddc8bc20bc1169bbfcc4cd6da918a8e678b385ab1a908a91814678ca02c9e9f1e93eecd5d803d1196f2f858d59875dbcc61f698784f3b38d24f586b43a0d69697cdd37d682a1084fbfd2415058537c0043f23d74fb9c8e706f843d7cedba0d121df6bed9ebfae7d1f2fad74d25454e0670203f7aa11deb6e1ef7c1b830515a0e5bb3a8ae7c7a6f9ae62501b584cf922678abd477e4bffa164395cf1e78b95bea0f90c0552a5c3005436c2a312949942703d5e6fef9b150d1145c2afc7444f5c91a070d30c33545eeea05a3a9779c31a9e544632fbd62723d2f93cb97da16e800f5aa0b3888a53febfd2caba6b3ab8e1c7abff4ee236391fe73b62916b04d92c661bef80";
        accountStateProof[3] = hex"f90211a0a34e0c8b73b0728a920ca0b181497b67d555a46cef9ebbb4ee2e3778071ca3e1a00c3d8730e60c450b5fc6f172c1f86640a721e0ed9a7ce5549c82f0b107d9968aa0c9a24a1c68a6f2b9f474a47b9a10ba0115ef19c88f93c9e170d72d7947c7e502a0094a59ff8074af24a9af3acb823debf4274b8b81e245eaaade0c6ae783b6b2bda0d1c00b6af528694bfb2f7dd76c92f4cd1d0212cadc54f60a8790d6680a525799a074e2923c04a8c05f4ca97aba40a60ba89543d31fd48bbf5ac3ef3b169431d2d2a0c992e69efc5432b19c9a7dd85f8ec19e7ab31c6d2b1698b565efd506a7266ec8a0441db858ea966ab15b69741e09470a4dd85321a50988033057a4bf2db9a71842a062566967ff58f38539d6622f335b9e653279ee1af90950e09e918864726fb5e8a093567d90755d334df69ecb2ca128959bb6d8b399b51b43a4ee2f57e17ad3bb70a0f48ee1b9e06b54a1f544053bf229b84f5d0cd84666ec490fee39573a60e25714a0d27356a068a370bd72d1eea8f589b51f1d6b81b3d64a25e68e4c82d006e91b04a093025f21d2236619c1570e0bfcfdf59df49c374df87ae53feb6394c070ed0c59a070d6fd6889397490369fbff6be50470305618b6cda0ad9ad5aa05c1116b97f5da04512e7e3c30d2b1bef4388470dd599c925f916f04f8b8687a5fb9962d78b51a5a010c4a472f94af0f63ef66afbe1f39b3ad75b50a259445169bfddcc3f2bf561ef80";
        accountStateProof[4] = hex"f90211a0b233f3b712d0ad6d92e4bbc0ddd3e60857f6f832febd7985a8d448aca90e3f4da04e2b9a7a2f398c2a2735a9992ec3d43ef0084e89f35a119031ef63683ad61a6fa0c8db7406e36520ab1ecb747fc1bbe63106a13dcae2c0bb2d557c4f6d955a5a3ea0c483d0d170788d05d79d16bedb5601c66083acf3a5298aa66fc8f3024e29e585a0a05281faf03b23a969b918f71b15fa4dc1c28914ef880a780fea4c1cfdab3c4ba05716ffac90cb9084cc1d6dd87ffbdb96498c68b39ff2e52628c767dd5adbff1ea01a86845f686e338c7bed9808c2b4ddf02ec472a159a7a3e24de055b2cccdc503a083d6527a9397e483325f4496ac429585bae688afeadc7de2c9be985ce711b629a001f7110a88abbbb0526b3e1ca7389820fb5ef0edf8629a2c280704acc98c8e4ca01bb7d549d1a98825a00be79a8a1604c4a8019b77ccd7f9624d204e0e1ad2946ea0930649fa9c3fad72490a24d4d8f6b355ca5d09889194b28e68a32e3c5bc0a165a04adafa71e336eb2a8f09136ce82c966ff886a72ea3c3ba4e4735b9a0f3751427a0358ad433976d16a7cad00608b56f4f3587ece582725c88eb5c6f96973e8659dca080af7dd597e92b5c31573e28743d0df4fbe8a6d50695da429e28af4eaa1358aba087eb0dd9570f0545cb0be02ed68c46ad01b1c463517a82b097addbde156b8ff2a0447b9fb70f70745157fc006fbf12ff53f57518fd359f467f5c9189e129d672ad80";
        accountStateProof[5] = hex"f90211a06b4d27b4983af7beb8b89710be3563c54c8c7ae6f99a6ddf8894ad3cf336c2bfa068bf0dd2fc6d63e8ffbc5a90044d8cab21bfb3c0c23c76d0be11e64c2b02ef3ba090ddc7c34ad19757784683e8b961b34ab1dca9d461534bb21204b3d1ff28d606a003db9ea3bf86974cf71a7641f227476238b86e14a7289529b7ce1fd27acadf49a01c9963d16f14dddb144a75b5fd998abcf31ec253e1f25eca52d402fae3fdb6a1a0b190569e11ded5c9f9a3a0a3904606d0d6b9f7ea44a97d24c0f68cf56756ccf9a0e1c9a11fc25085e2a7ff4179a3d23de16d733a41deec397c8bf8cb9125c643e0a0ea8efb093992a00b9497d108ba07eba26ce8e40c9ee3861ff46a66535998e03ea092d95c94aa23489c7886d5259c2a51fd0c93c5dbe5cc16aef73da38b1e0fe39fa0a4593bcb6ee529322312470ea4c9a8111e59b4eb4da4e97349d86c8a140424eca0469fbc18306b635a5e4d5bfa49775d002b7192e66cec49b1d8a28b15361bdccba0dbc4791cbb20ce2288bf75c092fe5d7ef34a7b2a2b3f486ec18834c65c12dafaa075db9ca92db74f781695c1b0741c6c98491c3e055a5ce4a0d50eb14ec9deb401a08aee3280dd5ed92116e0d3018741274dfe60ae8f5e9cacb329149d6823a69709a050bc0982b081ec923a6a6febcd2b409cf07024d2d042ded2fc3338fbc032dab6a0a63e11dfe67b0849ca550be42f99688dfd305b1ee433513399bc1376fcea255280";
        accountStateProof[6] = hex"f8f1808080a09d6c8b968b2dbccf36140d12dcdc671135bb772be4c5611b449c7ed6c30e5653a0821c1e102daf3114753c9a380a3802263b85113bd2a141c94e9971751a0458a880a04b26bf624e0dbd75603e3389921be09270a04e4206bb0c49cc8336b1601aa3f4a0e0d81d79b1714e24469abb00b2a4763175961c0d65b7947ade398b628781293980a00f3ea319fa144d937cec7c6a017542dc962b7f8057cac61cf975c4004dbd3545a0c26ceae74ff77430837fd944d8ce424270dad5e9e66ca7a4e3e00673124c84a58080a05bffee2941aa858fb0e58a832c24b86a30092b5d113bc1a13bb567faba30b20a808080";
        accountStateProof[7] = hex"f86f9d3821726f422fb8b82fa114f52b3302c3df4cd43d3dc0cc57b54d50c84eb84ff84d80893098aff76cefd30000a056e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470";        

        bytes memory blockHeaderRLP = hex"f9021fa0c91b00acbcace108a1a85dde6c2a325300bf6831e412c8035727e28da4d5162aa01dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347947f101fe45e6649a6fb8f3f8b43ed03d353f2b90ca0d084c445f4634eb4ee3e12755854dad8874cb5d2ca48e7427495d1eb1bde6fffa0aafb8b8dabf5893c6292eaa8ecf22225faced13916ea237a36a71d939bfecd12a0299bf2d17be43f123b22c5473e5b091e02d77c095f460bee9e355992c933c611b9010018ad003041004816010081088050032130400401c001001800050142d4400000180000101068420480404841000229000a000201091030034000010000762005080c4066185004aae80000481005002000c0806066631210100000018000010492a02080020240042050406084300841208020040e122c8000a84010004800002464014402124000805a010020216100450044010da0000880450042495002088a024301c40264040a9040e0850844001104480082a1000281211014400f0010008c020204080000024001002815400080002240030a06100000094214042200043822290400080800249080018488205b102021089901400448482050002802872ada24f8c00b2e83e8d78e8401c9c3808335a33b8462e85d6f97466c6578706f6f6c2f53312f4252202d204d6164726964a03d84d8a85cd6962963f900624aee6aabae09dbf22876d4fbb19639dd06b49b53889c4dc1130d89ebef85057c79ddcc";

        uint256 bal = wrapper.getProvenAccountBalance(
            accountStateProof,
            blockHeaderRLP,
            0xa06568a4bf2b76d845256514dcdd383df660cef74bc7756c4a52522182e74823,
            0xa2524611561D053F17C45Af9b746F9a7df2221A3
        );
        assertEq(bal, 896446000000000000000);
    }

    function testBalanceProof4() external {
        bytes[] memory accountStateProof = new bytes[](9);
        accountStateProof[0] = hex"f90211a0a464d3241847b284e42c03966ad492de7898af5f5e1dcf1a1efce6548ed2e5f0a0e483adffb385a1c60caffe1fcba10d59989ae27bf4ead52d07b5adbc22926866a0c7e1ef01ca6fbf527c87763e2764b34774288ca4870a36c45ff34781a4ae841aa04907cc7bcd6c82244fc91a6ec3382ab5e9d822a019d721e971ec269304af2d00a0d1e4dcbc95a500925356f096c3ecdb600501704645a47bc82ff73157211c8711a03b75bd16eac5a9e09ea163992c03027ee1e07a9da7f084f1f4b5ff3f96ad3499a0cb63eb021018271c800a07b276836c31612759fb62adb5a2b6dffed3a333394aa0bfa5bac92a92866ab9a0b4e162c2c8665db8c86d1854334cabbe2b67bf37843ea0b655c1a1de06d9dd6274b9b971eed839230e918b862cd061b949991f22c946b2a031f140a763ae4e76cd8f585afa968b9b15b99a07b206db61ec6973404682967ca0cb2f102f273201ad1e02a70e0714523251c105382866c8217afa0578fc9be84fa00d5475d71988e0b889884ad064445bdfa8cec139d429e07d316b4d75311015a0a0e22e442d673036b00f2e58dbd526ede8b3531c5f00f38210ddeed56b3b9105e1a0c47006269224487f37dbae7e2155bcaa7d146be2e55f759d35712c94f3f29ab5a0fb8b6c7c65244fa195bcd25ca1c5bfd54ead5fcc79c0288066c31f7fb2873530a09a784b3aecfd0cf44bde34d56af92ab4bcdd499ce4d12c15e8d84a17dbe1cff780";
        accountStateProof[1] = hex"f90211a0933fe9c206645fb67e78b6740dda1be41630cdb9dc5be0f861064693d36b7b4ba0c438addf5d80c2d9195616c65b6d8281d654b11c63f10def233281780957f110a07fb1665765a55faa40c21cf35255f43658f99a5136fa0e61e2d901890e45d9cda0ad1a59a5e40eb69caa06caa4f14f195e29151a7e88d9c229722b8b47c8359df5a027c131fe0fbabeb82675213ed129d68fce87101fbc73367d94558b7d1760d050a0a0f798aa045ffcbadcbf17b54bb80a780031798629e3a8bb0df92c1014c9543ea00ecc356a75dc51d7f19dea29c28124f224c0d7afd1e70e05c0f7b8955dfceaaaa0d63c7e92c364d6513ec8658fa62eb3abeb114e99d7f36137b2e1a2fc48083dfba01e95081eea1e6ad2ad4318817232cdda19b0cd23bcbe7b95dfebacda72d60031a0fd9cf530cd7bef7938696756f42c78a273dc9937121529a59698e187d44e3c1ea08da0e812ebaef7ee3ae5a33faae028bb021480e8fb73a1e6f96ebd71d4a9c84aa05cf1a9549e3d16f64036aadb5658a5a0939ea81fcacea332192587b384cd136ca04a3bab067fdf0dc4c69dcac94bb23fb3633700a6005a66d0a47013de1077ceafa03e30e8ea81943003fe32150438fa04990dbe9ddb532a2974115da1637bdfd693a0640c6e6872efba3d445019d2bd2b2c5b9d56bf12c226c4890d8f8a5490fc9f4ba01db41d3a441233a4cbf7f8c38ff2170403a4b6e2df5497a3450b0f342cbb695e80";
        accountStateProof[2] = hex"f90211a06983f044fc37be9653175c62334f87c385c35f4878a704355b5c35494010dca0a0c4a019f83f368c1ace2dfbbd06b8570ad9a57b44b2276d16c2679a15b94a1f2da00bd91397dcae08f4041a79e2b245600a33a9b081ff5eb5425b25da04fbe00cc1a034a351a9f41fcb0dfe2d316091bb36be9b01a8c251b4250fba19ce8a5b26ef48a0c644744a18680d42eadf801a471cb30a8e2751803312652fb8d389bda04dd7d3a0948035157c798bc74c9cb4ae4215296cd575d59cf8b951cae324a084404cc9dda04a117991faf9a5e34f547db0c66ebfb00c5e0f634b835e34982f5a519a7faea7a0cad237d8f5d4a3916dc1c0c545c006621de8c9e9d90d70b0358a8318c9d35e8ca0fbe25c7247ec6d497a7955b9f69427da80719535f43dd2932691ab5c56211237a00f8fac550b202c632c82dbae277d58ac1e04fee9273d9d8f44446f42f7f2524aa028092f0b450bbbca4f5f998bb705a9dbac08bca4ca038ace373c43a3d7f7ad27a066108ddd6d2fe5c331c7b68d42c3565934e3eb8ecb051bfb0a3422c0cf3987c2a0cea1b3705d7802f68f0a5893cc0ad6cfcda30f34b8d2d9765cd7e9423578de5ea0804e75e3fa155aca2ea6ed7ce0349272b053968372169b48890a6d2134255147a066474bd0932b1806440c169a9d514f51821d44013e699b7b903dedf9a70d658ea07cf2b34eac70c1f07b65d6bdf0b11a7e3d8c90d940fb13d0df48855b02d78ec380";
        accountStateProof[3] = hex"f90211a063988d34174d6dd4bbcc3a8f0a2eed8734408090648b9d33694ca966383c4deca0b4b0e43d9aec8858f2a8aa3d18046dd578a0a8b3db2fec351bee6a08cd7faf0ea09415ff4e9e77f2f31f4f10ba034bbbc2d70f86b244c40e100eaefb9d40b4b39da0ab9a5e0d04793dd90036b5e9d35c4446326755b7e0a19e3ce1fc07ad92f29f02a0537c4a58729b90eb16dc3a3feb6831218ea348e0000c1eaa23aaa15251c1a2a0a09833bcafaf9ba385abb19e84df45eef07bc0806227ef374d00e091fb21f5be5da0e9596a3df1b987d76211bebc30b630b3d60f2c04e370165f56f1a1c338fc6838a07c80bd6b68f604d9a745614080650177593ac6ed87342ab4ca3358708a2e934aa061e2e214bd5548f6277b2cf503cc4dd2e23f5064aea4fe9e8fb8d05aed5745d5a0af56c6562b037ccb442e4a249e48f01a7105290f3c477eccf7b7b98c03af35a8a0dfca083ad538aa38d380a2d354425dd8a23aeb159922807098837ec37cebc62ba02f722d343faaefeb8a2bbeb6ef1f55f0676617d248c47fd403447c991cdf5c6aa0cf72a91fe3223988aaef099811cd098e3682add2a7c80501086dcb7b94358ae9a073836f635691dfc5edd0f8d201269002efa4778aa75aa9777014c73e2e1158eaa0add9aca2c356a7052c3408708526e012d68b0aabb24929a8fad477647883f0eba0ee078a13b07096816cb319b10c3b522d998a58f625903d8e5cbd58f715a9b0c380";
        accountStateProof[4] = hex"f90211a0fe8db2500e0ab9c4b98b5f73ab7812284cc85e65bdf5f615f17338cd38bf9131a099c87961e18c65525e9ab19cd489a84c83829304cf9a64205ec2bbbaaff6e5dda0d0f1216e74e5a88af560f171d18016ccc6df75217a3b65fadc4afa5f70c293d5a0e12d32ba9a2bb60a02584007eca3e0c07caf79b2ec307c4e02dd3ba6f01f0f97a02f31f078066f55be65d224cd61a28dd556f773b54c9c17b7d5b0b7d921d7af04a0c8e263aa333e4fa54607eab57c83b9f291ecde6d34d25e4f3f2e56858de3b0c3a0abe619309578c3ab7726057ad6fb3c58119033f941369710e9799c66ee712f67a026689391e6dfa41acbec0d2245522e8f3c1b20d09d2a57f58181ef8c757fd2c7a02665849f60971ba58d2e54fbfbb334aece60221426e2bb387624308dc22236eba05b2908d5d8038654e182063e9da6f6ea738c1e3f754b3569c80810cd728de15fa04f00b5511298059d99fdf27a5d3bf3497c5c625e029497275d3963198fe063d5a00a44faa595254b08dc3316197792ad9e5365f5200e788abde009ddba1b4c08cea0f6eb04292f4401d02483e77b32821cb8b714eb8565e604673202b3d4f1118bcfa08978f3332e7e0f7b6b4c6407e5efa06658f00680500145a24337d88321500085a04c89bb5fb5d8fe6359b89e97a399fa8bdbed9193796f1ebbfb303da9143c4938a02e513bcc4bc94f503a8fea288cfddad9391585c5a664acdeace61a554c15781480";
        accountStateProof[5] = hex"f90211a07a1ebfce00f75ef6b9a130f475f782e31a4ea9d89d025e78e8dc5c6828117747a0704b3912be40747d5682159b5ccd7bdad97aba1a92eb353a1b5a2bd74bc1c9eca0d0608f545aaac999124f6e54359c2158e1268d7d9859d043b3ab315778334d76a0520995a960380bfbc382bded4bad79509ea9292c94aab3135c4537f91039339da00cc156a61a238414c97957fef26d87795a593e60cd179b185cc012f95ef57e71a09d762b8363e51393e4093c08739861a97cfa70b0778dd747aabefc5a54e9c160a0e9650c77078f8abf684b35d55b0d1d9263d83d84f134bdd40becd60dafd2cab7a04ab29499c2015884623598b7110991d045c7924bc92f2872a42fcf7a200cb471a0542479cf57a3f768ac143f47fe2e31f5847260603e3054f10c7e36473905c4b5a0882c074ff0bde58aea2667d7e26422025ad4d6577eef6b4815e83627db78c21ca07f9fd1e8d842f1aa7e7a30a487b24497f4db3f7b4e3d0c946447b081e1c16819a020412dba3714f1b6eb7b1e0a9911eda0b6ce3c0a238813a23b4edaec8d6d82bda0ff32d1d6180354d35b56494bffa61d0006fcc4633406a264202d882754239c20a0eb49d71acafebc0c30eedd21d2e2cb2cc29c4c82536109fd0953b119d371ad2aa02f23d2743e3cb211e28169880b8cbfbea7c9fa12556eaee5c3317e599cf48d90a039344ddd17a1de06e2e3ea0a105dc50dacb0733861510e4dbcf1a8f42207215e80";
        accountStateProof[6] = hex"f8f1a0eee807967714de8469ed3b8998cda5a1ecab552ab2f85d428865706dad29d91780808080a0c097a76435bbac52c565653c61dce0e603745e5284d523c0fdd446f4e6de6b36808080a0cd226b3c59e80a30fbb6b9519ee9540139eeeb9b3245fddcd55fa1cc74a8981780a079eb56440dda2a8b220c7c1b3dbfc5f1ea1be232f734a9d7999298653a98e97ca0da296e9136aabfcb92fef2201fb7a5fa887e042394b52063749abec0f7e00ac5a00f02e1da0d2a8f021b38738608639860d9baf426fa4a52504963def2d6a24335a0601c3430e6e6e6c80f0e13d2c53690d161ca94ce3477e429727d886a552abb628080";
        accountStateProof[7] = hex"f871a00a676715f396cda27911039aefbf2a6638c857a3008fada52b0f4b75c00174e08080808080a0e9a51ad0ce76c5ce9ed15156fd129142da8f1673ae7355053e39076eae90335b808080a008b3c1509fe7e882e4104144c61298c94492c23e218d48c93b09781206c0c726808080808080";
        accountStateProof[8] = hex"f86f9d20e11861df8159b8b6ee933295351f1587d2b5edaf0c1d85c4d04ca9aab84ff84d808936dc4e5d00997f3c00a056e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470";
        
        bytes memory blockHeaderRLP = hex"f9021ba00a2f47afea2ac9cf35646309b68b7c8f921da38ee5c6cbe4d95693ea455974f9a01dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d4934794cd458d7f11023556cc9058f729831a038cb8df9ca098b384abf864fea8043ec1d739e0a05d3dff71e9187ab50cb524847d3a2b1f19a03edaf7c09e83eca8a0c1f0c3d7cd185f699638d1fc984e7bc58b7ce106a2561ea03d8b7821e60d2fea5ae70ebbe7b02aa1cd4015d6b5e3e479fe23233af9d80903b90100902040084208008802000280880000a400200420c1040400200180401680000031240a92044a0000048000000001010802812060080422090040000040a00200400800080080000e298100a8002025600070502a804400010a001040c100040002400000820200201810200084002d111000881048801502000100900008a10000110120200210301808400005012024000400810184004804010040001000008e000100002860c2208000c040004600008120000002020200000408012004102160501a280000401264000000245000040400400000221384000b1210306204809a20082d0002000000008009200e0040000009808a41420808645002020020872ada8252f1e98083e8d7948401c951118333ddf98462e85dc693706f6f6c696e2e636f6d21b50373ad9733ff83a03a6f854bfef42a27825bed572870bf52e5a7a1a34d7ea35e9355455fa660161a8800faf23d8998a06985049e51eef5";

        uint256 bal = wrapper.getProvenAccountBalance(
            accountStateProof,
            blockHeaderRLP,
            0xad02ba11cdc27c070454c459f756b26086b402552c2ff4c7f43165047cc1a967,
            0xEf87454C8EBDB480D73C2675e1228BEf5C2e0Bfa
        );
        assertEq(bal, 1011998907974000000000);
    }
    
    function testBalanceProof5() external {
        bytes[] memory accountStateProof = new bytes[](8);
        accountStateProof[0] = hex"f90211a005ecd4e8c58dfa81d7f1ff53cb8583b8fcd997665ce02f30f3507ae83cc46b37a0b039f59a09b3dbf61edba1c36e303ad98b55a03aad52c4799457173f4720f607a0f6154bc694b5fe73dc214760fd157ec15012b14bc2507ee55b7368066d7763a3a012f98dca69aa81242427a598717736e59a5d9f96718daee2c3aa66281bee0e42a0f22bf84646058da88982ee55656faca1c91b20e1c5eba92bc3d808e16a052cb2a0be00de1efba8939cd15effaff956b070710d2d0fda5e0540f3b8d6b4b8a48be1a07c6d68560ddfb06b242836c3eaef1fec5f1ac3ca605f4e14793b6c546512bb2ba0c4daf7c57bb96194f45a0d697bba1d675bf7f1637404f5db2c75a6d9346145c4a0ded09e82a70238a422b7d8740381f6a62fde252d1ba9f9b4a917ddd3f39bb8c2a02fc9f24119f10597d94f4b598d1fccce8d309eff7acdbe98c8f637d6a6cb21b5a0d8d9b86e2132fcc3e09d2a9745a75905ab3f50fd351863f9fc94727fe8371c9ca0703fb5f179b83863175f8877b06296ab99db347da9a109092594e700f6ab3c9ca0ce235a6ea9eef2877297794473cedebc486ada730566297624a06669da5f57b5a0f9322cc4b650963266d914403171c1bb8ef45335fef7d84dbf2f8d3fdffcc4faa035cd9fa7105102742b2d1c9d580013a5fbf42f60b6b23f4830b06032959f496da0f203f248116fb4dbb5912cbe595d1491c46fe524cfb21ccc919d02d4bcfdc24e80";
        accountStateProof[1] = hex"f90211a03547207e4ce2d71054f132a89ec4d1bbf307d1acdfaddf2f9358ddb2369a678fa020499fdd628d4355fa142c879773dfd4deaa914e7eeb4a33b41b84bb23c90310a0d9077ea8e012b9b903ed1f87116750adc40341d1c11077d3491bfcd11cafa0f8a0935b0dcc3a1dd2feac6237de63704526dc1d2fde802e888e06e02229feec4364a07adb37c28a35f85e219c8439d390d02323c18cfdffdf8ced939fbc44d9458e2ba0c15c3c3947c30dec5997efef834b2062596571d3f5473aa17806acab393a4229a02a24caf748837c6a9d7240d463370349cf36e8737b19778f03213c53d281ab2aa0d3cc1aea700d3d1c53d8714d0adcce1f0da7e7607fc45af24496448102ab9cdfa092f1e528e1f850e7a2bfa0f3e698592ab88aa711a6720dc41800bb499fcb2619a0d7f3982ab61d76ce8dd0f2be40cc06a01743d42c66ac86826f23c8e6c60141aaa0cf2e325af2530547abd97eea782f0226b2e67a6e7265f486e94538da159a9e04a0c7c9bb5e9606ee5e122a688d297b34d4ffd591c5dcd00af67ee35d803ea6c419a0312b8a1569017665d0abefd3c983b0a1e3c05afc335caff44bdd73dca6968bb1a0f184e2369bee40e68b445cb2a9778bfe22d086f251af1b75598b017e8292fe48a00582624a0cde9c859232d291ee8145db425e50ed67a92835a31ad5260ed31062a04f03b2923298acf9e5e68e0b7637ac0105857dcb0c94e347ee72e911c7f7769380";
        accountStateProof[2] = hex"f90211a0be96d8092623ce205a847999ff3bc11a22876ae776dcfa97e8791bd4f9a88939a049c8907c972239560c33e25435d87980d51ae9d2bb0ab9e5bc3c8fe678679d6da0643407c3b4b9ff7e39ec4e144ad0281657abc94b91c7460c603e301ab735af94a040c09d37cf2930296ce1a3e2068e028cd97fccab1673c7f6b2a0863e9cc6dcd3a0e8196cad7d5cc96b5a5dae020693465b846629b2ba6459d5e2dddd94a5a62d69a066bffa1af2c2a4fd5093006f869179aa1318f6579ff57e195e961969dcf9bb42a087e4f84dcad02be5ea3eb7757612f978bec1bd2aeec721c437c36ce50c80ed22a022f4e15369c329c50817846e34917df64384f3d9b17b60b2606a4fbae2827a40a0543992f20d9839cd21dfa7fa208b464a7d381ef075fcb1a4dabbe2862fe0d2d4a04f697a91fbac9039e681bf7900a7c1d351faa6a5319f1b5a6a1fdde68f8e4fbea0ec3c58077404e7002ba36df8d2ac18a825fe828987862a3a64cebc391ae4c8dca05682c09e5cf951a1593c2d597bcc280a2f0431360ec5750afd73f6989ffbc03ea09de22b6b1595d58cf1abc958d72638b1065bcfcaf612b2d340421540d5298195a04e364a18df2c274c76a2862c6951e494cdb96d53d3118b437b28cca2ae92ce78a099a7c731f8c251e3f96e3ebcebbde8b82cd1149be298171724769ae82e675f20a0701322862ea34321f51bec60051cb5cca04272a7621f5a7821146ad24569dbe880";
        accountStateProof[3] = hex"f90211a0f74977df9ff57a6a63cef72fa0ef8c87d1fbd6e4d8dded5fce5965a925cfe89ba09a65b8b27228f9eabaf329fe5a4669982382a4037cd71e9c81d1c0414d1f920aa0fc77b7f4f29bc40a6c16a28f189e0f854d5d7bc996dc5f73dc8807567172ffdda0c54d7803554943d26d5ae51d994054ef5220e4ad001d4dede61ef0f7ead3895ea0fb72947e4e6a80101d8d8c0987361618fb533a7b4a1d48cf98c0fa81579ed600a051c9bd3f5eef17e31beb34d754ba366a52b83f1f36a866e49aad1b65bd1c19a3a0e747fd76290d4db820039a9004b48a53682cbd43486ee45100584e73dcea072fa0c1ed7d6f7fd06ac69db6ebabf1bcc4b79ea81353e1bd5d66bd6c3c89a64082d1a03484e5bbe9912052dfa19869e11837405e4b2afe3f976afab539aa7a0a2b40daa053aee49a32ede10bd3e72b8d0520086f49ea90e23fb401a631144214426f34c1a0e1f3ed3d87c5ab14ee4e554c41606e041c9bf64f3ec567a02470941c6e4c67c1a0a6e29ea5384cd66ab6c9bcf2895091317674e99a980c4c95f17ac79ef8730979a0ffb1b3082337a1281c6b1c33dad1d09a7924b31d7fd8f87eec11db73239d0914a050bf4e83b83ef7985cdb3651d1513b28d7a4dc8e42a74e7c9c7dd26895dde361a0285d8b8da632fb88323602546d97e9fcc32a357dc078478e61c01f17d5ff7dcda00008a3c2b0b8795a30937a1bba20fca70bf1b8b3c6d25737a0ee616db21bbfc780";
        accountStateProof[4] = hex"f90211a0f5a7ef537fd4e68503d5a29cc4ab45620d552929a926861343fcdb826632f0b3a06167709eb918652094a445b6124b1e3e2f3450b1bc68e094f1fa4f89affd7958a09d826c206606d7d5e886c76d3a8f9b3e907823193967e4d949d1d77a2c68a828a053c654539131cae8e56a489f957053e035ff8b78e878f8a1c48d0bf4e4c8daa2a052a9a894cb8e7eec118866da289109fd6eb5441f7b125d93fd6368bebd97499ea056f153c40e7e00d8b4ece082515c77f110e8bd58a11751ffe5c8dbd1f179c7d2a044ecb47d11ee591e3e027bdbfc88ad6652819df2f755d1163587f4682c15f4d0a0e0e3452e67b2e996a81328877349ade5e7f8b8da9140a7489e20c9e78854a7d0a0593afc8bc66bd1ea863f9ffd5ecdfb691c96defdb89a1da04a9d42de067ddcc6a0bdd47421c677486fed15e83a5f3c39a49e4364733f36f25471035f02286f6028a092ee9254ebf2a706023123f99eea0549ff98f44e85aece21137f0c4f477faf38a0388be63dbd9be8889e62d4445239f6dab213bf14568c95e4f7c1131b23b9abc4a0a20952af066c24fa79e0e44ef5c6531b2665f1d42f346f959c6fb2daae1223a9a0c6be8b702d7f66cdd9fddb2dea62c446bae2d0b16fec63606a39eee58dcdb9f6a0a200da599b86c6cf5fd6332cc3ee36774e29f35843456aded6505e275a5ee5c2a057b1c39d82f732b6a7e878cab37bd8f2bc43205b794861f0b64f1d03f5f6b95880";
        accountStateProof[5] = hex"f90211a0d421a8994ea7716b573dd824e4461f57156cd4ef255ce2fef8dca8679e2abefaa0d3ba246ce4eba46492d006e103f30053e87d8707023457975ea47b63d08e2a2ea042c77547388f62eca3e86bd7949035dff97fe9c9cb6962769bfc915f5348737ba0f27ef6e3971811cd0445d25e62604ab886528a5ab52daeda0e875ba28969cc54a0dd4c9b20176f79c58a1786c8f7eb3aa7e37e3592c05e2adcecbb9c9a39a66d64a064141641571b0a5156854fc8a949791cec07493975daf33220fa78f6f377cb2ea0d6c639f6dd48cc69bcd3e18c4eb209c19bfd9ad5e7aa2fa66e2784bb6d405e6ea026d1ccd89839492ffeefbab1f8ba7f1b51c1eed35c25ef97742de475760cba2ca065bdc9b0f235d2a286faccacdd239e9734d4327c8db4b37bd3070642db135505a0bc0c5ca20191e4b758d53b07123f7fa1b1a306b1171d0afb265ccdf64d3e713da0f4ff2bbc4a0c27ece1c65fc0f5bd8ba4285e496f04995501f962fecbebe33891a038a9631823cfc2a21037275014635b280bb3d8be6a6c6c2fa461f9ea534c5261a01a2b8258fc5f41e87c63aa17eeb68d5204a14cc2e39295c8c5d68a6f9536220da0070001eef8cab827aca94a5cd31b8d4571c4986d3aca9a69120fb74d7fd35d1fa05dc8f9d3632d09d746ba792b445e4fe010620ce1801fb3aaa410be9568c9fc37a096952af3b92548e9f822f323ef0515a02eb5d73328b45b219dc91a18c7f3710180";
        accountStateProof[6] = hex"f90111a0eb61f0c39127ce5b5f462d9aa55f961e822c5a2d30232ad0dad0f7b6a3aae87aa08a9ce0dfb15f5304157ed0aae6fd1a77dd3f124fc9e0baaab50474371e90cf2280808080a0cd77723ddbf427f0dbe60d2437330ada4aeb022a6994620b8cb47278f17ef35280a08f64b6357af87523d7edb6d32c0c1702c6ced93306da9c6452d55ba6e2422df2a0f0a79c2a741f34d5855d21d48114723bcd36feda08870546e0ae813278760b3d808080a056a9dfbaaa947a101ceb6c3e8e2966ac4becb1d7be3ff675a8cac143bf3eaeb9a0d9ffb2819bf9e445d5fc8c298c1abc5e628bb7c24ba4bfabc3e5b9c0a11d7d28a0dd92149a786a182354b2f3114a3ee3ade9bb54c5d382ccfba585492791bad83a80";
        accountStateProof[7] = hex"f86f9d3f46f96a6f11c21517d63186190466b5367bbb4fe5e258ffcc3390a5e0b84ff84d0189bdbc41e0348b300000a0578185677cfae05dcabaca024012391e4797baad17b058a41ad2c46d9e48d4d2a0aea7d4252f6245f301e540cfbee27d3a88de543af8e49c5c62405d5499fab7e5";                
        
        bytes memory blockHeaderRLP = hex"f90214a086455cfc09a95267197e6daf925c75effbd55b38539004aa1fb51cdc5504682aa01dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d4934794ea674fdde714fd979de3edf0f56aa9716b898ec8a04048793b47aceac280a8fe4c7acaeef26e3b1330ada8498bfc10bc5692778d45a0fbfaaa3828e74d59981c70f118bf8454a9a38bee52fd9c54a459b380e3857023a08bba88f9578f058f989655c093e81d5d5570f5bbe4c7b8cfecf695fe55a95c0ab9010084a8d806611e591682862018aa10112440c0c600a48604228a211082d40825601529018014e01000a1802a006c60c101c208d0200948384c0411040158bf2411000040284101862aed600ec8001045b044e210c004201803044070098b81440146208600022a400200b0593080a0096122833c400188023128210099080a80504080c32090e60210410702404a049032150930a109000059050100c04018ad028a488190238eec001cc149848d04c8a040349023080004221061074c812c0904201040020903a990acb0c020036ec002014100548908c41900842a64e28023040612a2181b1a0004851390b0c136450004282005080d00610c7e1bd3a0003caa872b1ceae66a22e883e8d7b48401ca35ef8377c3f08462e85f118c617369612d65617374312d31a0edd91ca4a000b467034bc1b46c64674a04b43db608b7d83a7592ea2f7b5ea44c88d3639ed7576dbffc8502338530d4";

        uint256 bal = wrapper.getProvenAccountBalance(
            accountStateProof,
            blockHeaderRLP,
            0xf916dca886a1a462fef6276d221bc2b233f603e5ea30feacb5d508bf4151bf3a,
            0x514E51c4FA258bd7F88d146c4a87Fd4D2a32796f
        );
        assertEq(bal, 3500000000000000000000);
    }

    function testExtensionNode1() external {
        bytes[] memory accountStateProof = new bytes[](6);
        accountStateProof[0] = hex"f90211a090dcaf88c40c7bbc95a912cbdde67c175767b31173df9ee4b0d733bfdd511c43a0babe369f6b12092f49181ae04ca173fb68d1a5456f18d20fa32cba73954052bda0473ecf8a7e36a829e75039a3b055e51b8332cbf03324ab4af2066bbd6fbf0021a0bbda34753d7aa6c38e603f360244e8f59611921d9e1f128372fec0d586d4f9e0a04e44caecff45c9891f74f6a2156735886eedf6f1a733628ebc802ec79d844648a0a5f3f2f7542148c973977c8a1e154c4300fec92f755f7846f1b734d3ab1d90e7a0e823850f50bf72baae9d1733a36a444ab65d0a6faaba404f0583ce0ca4dad92da0f7a00cbe7d4b30b11faea3ae61b7f1f2b315b61d9f6bd68bfe587ad0eeceb721a07117ef9fc932f1a88e908eaead8565c19b5645dc9e5b1b6e841c5edbdfd71681a069eb2de283f32c11f859d7bcf93da23990d3e662935ed4d6b39ce3673ec84472a0203d26456312bbc4da5cd293b75b840fc5045e493d6f904d180823ec22bfed8ea09287b5c21f2254af4e64fca76acc5cd87399c7f1ede818db4326c98ce2dc2208a06fc2d754e304c48ce6a517753c62b1a9c1d5925b89707486d7fc08919e0a94eca07b1c54f15e299bd58bdfef9741538c7828b5d7d11a489f9c20d052b3471df475a051f9dd3739a927c89e357580a4c97b40234aa01ed3d5e0390dc982a7975880a0a089d613f26159af43616fd9455bb461f4869bfede26f2130835ed067a8b967bfb80";
        accountStateProof[1] = hex"f90211a07255a431927266a90d40eb7a692bba6c6366c9ce11113ab856fc2203f3bda0daa0c954a344a1295f78ab08d8ccd56ad1becc3c64c11b18798526518409aff5a2d2a032bc3411b882371402b1195ee297e8f54432bcf53bd1f39449a206ea71552ca2a066aca88fbf83cf7131452518519e9d916ac9fd1df0af09cd4d375b62db682971a0c7f0a820b950c3cd03251b398c8f2f557827bc84f42c84140bc0f87a4eee1deba0a005672edcad2378533c0650fff5be0a9805046b824a7eedd092d6eb0c3670c3a0b01813f806d5b725151154f312c9c3ff026b8eec2aa46651851676f459affbc0a06837b4ebc5d2d6150d24bda824658ce9e02a5b11211e8fd0f0a3dc1eaa5963f8a082d8d732853ed6578d21e812e4c058653243b911664ef659a3a3b8a318266dc1a07194c05e82a528011a740609c441df2860ade14a98abf382dc0cb660886af828a096c40dce3f7c06a72804dc2732f45a78019a4f1a0a9a5918710a8c52f1b20786a03e8bcb507d8e47e4a11e3b4ce7658cc81ae776d320d9ea998fd7bd067e24878aa0c937a15652ccbfc3bc373f05ddb8f4802247fc599ff8e08ba72ccc56b3482156a0affa9c12e32cf182e338fc0c5f89231eab07353ace76b05e4f1fe6fe786b652da0d301a9c7e4041fdc22cf5c7ca999c14a06ba201c134a1ccc7a18b5a754afa390a066877aafa128b25c7033648d759934489730150ad5e198919cb089497e1ce5aa80";
        accountStateProof[2] = hex"f90191a03d06d0cc4b521257ef103f5995e1d8213b09be4733d21e2fafaaf8f75ec701d0a06ad8a12fe246eac739ae356526a94654b6bf43f46a9f1fe43329fed563ce7b43a049d5e643fce7115f49b66025b4c36ca8a16ef89bcda3b96a32c78b7cb71e7d09a02926df7e4ef74eb1aaa2722ad211d4364a7704793987693763bce1383a898f7ba0230aee398d4de18905e7c4986091dd54d8dbee35c0652e0b07dddadcb96b4148a0d69dfd0ec3e5916a21d2156b782bf74efb5777255cff5630064b25d5e1d6f4b9a093bb1c5a445931bae7ac31b2800187993f3478498823670d299c4b3978a5933280a043ccdad2f25e04fdb9c8c258b635f923740e9683273730e605697b1250914b7180a0df1b0bcfb0b4d60b6f7fe21c36f7fb9274633e555254794f849253b68089587580a04f41b6e785b83238325deec4c7b94ca54a36110fad665e97b1058f12ced72394a07cd6621954bb990d323e02c74a170176060456388119e8c06cb821e0d2305cdc80a03e3e1e2dd08ad27e275b0b82c0bd6684195c359973cfb950fcd7da6b6384a55380";
        accountStateProof[3] = hex"e21fa06d090483de3bd21007e12de1454f8796a800ff4c637e355b28453b4c1aa8345b";
        accountStateProof[4] = hex"f85180808080a01f385798def3c169973eb21cdb0dd1e8a46c562dd7bc4c9e76687844644ddb03808080a096018679c0a0955ef3078686dff9605fd600ae1c9b16d0fcce5a1feb56d9a6808080808080808080";
        accountStateProof[5] = hex"f8709e3a36eddfb67d211c9c2ab14f6e170d8311c66e619661501e844f46f63c12b84ff84d8089056bc75e2d63100000a056e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470";
        
        bytes memory blockHeaderRLP = hex"f90214a00000000000000000000000000000000000000000000000000000000000000000a01dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347940000000000000000000000000000000000000000a0d7f8974fb5ac78d9ac099b9ad5018bedc2ce0a72dad1827a1709da30580f0544a056e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421a056e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421b9010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000850400000000808213888080a011bbe8db4e347b4e8c937c1c8370e4b5ed33adb3db69cbdb7a38e1e50b1b82faa00000000000000000000000000000000000000000000000000000000000000000880000000000000042";

        uint256 bal = wrapper.getProvenAccountBalance(
            accountStateProof,
            blockHeaderRLP,
            0xd4e56740f876aef8c010b86a40d5f56745a118d0906a34e69aec8c0db1cb8fa3,
            0xb2E085FdDd1468Ba07415b274e734e11237FB2a9
        );
        assertEq(bal, 100000000000000000000);
    }

    function testExtensionNode2() external {
        bytes[] memory accountStateProof = new bytes[](6);
        accountStateProof[0] = hex"f90211a090dcaf88c40c7bbc95a912cbdde67c175767b31173df9ee4b0d733bfdd511c43a0babe369f6b12092f49181ae04ca173fb68d1a5456f18d20fa32cba73954052bda0473ecf8a7e36a829e75039a3b055e51b8332cbf03324ab4af2066bbd6fbf0021a0bbda34753d7aa6c38e603f360244e8f59611921d9e1f128372fec0d586d4f9e0a04e44caecff45c9891f74f6a2156735886eedf6f1a733628ebc802ec79d844648a0a5f3f2f7542148c973977c8a1e154c4300fec92f755f7846f1b734d3ab1d90e7a0e823850f50bf72baae9d1733a36a444ab65d0a6faaba404f0583ce0ca4dad92da0f7a00cbe7d4b30b11faea3ae61b7f1f2b315b61d9f6bd68bfe587ad0eeceb721a07117ef9fc932f1a88e908eaead8565c19b5645dc9e5b1b6e841c5edbdfd71681a069eb2de283f32c11f859d7bcf93da23990d3e662935ed4d6b39ce3673ec84472a0203d26456312bbc4da5cd293b75b840fc5045e493d6f904d180823ec22bfed8ea09287b5c21f2254af4e64fca76acc5cd87399c7f1ede818db4326c98ce2dc2208a06fc2d754e304c48ce6a517753c62b1a9c1d5925b89707486d7fc08919e0a94eca07b1c54f15e299bd58bdfef9741538c7828b5d7d11a489f9c20d052b3471df475a051f9dd3739a927c89e357580a4c97b40234aa01ed3d5e0390dc982a7975880a0a089d613f26159af43616fd9455bb461f4869bfede26f2130835ed067a8b967bfb80";
        accountStateProof[1] = hex"f90211a0e45a9e85cab1b6eb18b30df2c6acc448bbac6a30d81646823b31223e16e5063ea033bd7171d556b981f6849064eb09412b24fedc0812127db936067043f53db1b9a0ca56945f074da4f15587404593faf3a50d17ea0e21a418ad6ec99bdf4bf3f914a0da23e9004f782df128eea1adff77952dc85f91b7f7ca4893aac5f21d24c3a1c9a0ba5ec61fa780ee02af19db99677c37560fc4f0df5c278d9dfa2837f30f72bc6ba08310ad91625c2e3429a74066b7e2e0c958325e4e7fa3ec486b73b7c8300cfef7a0732e5c103bf4d5adfef83773026809d9405539b67e93293a02342e83ad2fb766a030d14ff0c2aab57d1fbaf498ab14519b4e9d94f149a3dc15f0eec5adf8df25e1a038f4db0ccaf2e3ecefec2c38e903dfc52033806102d36fd2b9aa21ef56811155a05a43bd92e55aa78df60e70b6b53b6366c4080fd6a5bdd7b533b46aff4a75f6f2a0a0c410aa59efe416b1213166fab680ce330bd46c3ebf877ff14609ee6a383600a02f41e918786e557293068b1eda9b3f9f86ed4e65a6a5363ee3262109f6e08b17a001f42a40f02f6f24bb97b09c4d3934e8b03be7cfbb902acc1c8fd67a7a5abacea00acbdce2787a6ea177209bd13bfc9d0779d7e2b5249e0211a2974164e14312f5a0dadbe113e4132e0c0c3cd4867e0a2044d0e5a3d44b350677ed42fc9244d004d4a0aa7441fefc17d76aedfcaf692fe71014b94c1547b6d129562b34fc5995ca0d1a80";
        accountStateProof[2] = hex"f901d1a02c08d7cd61c1363da038c3bdaacda32f30b1e4cf1f432cfff9a64865c5ce2d90a00bcd434b1f5845c7daef47a067c256bac2e3d5ae4b7c28fcaf67e2b9ffa98359a088afe85e4bd4c31f058741dcd5eda6aba96e394417021f96a21b898c70bae9e9a0e740c2bed03ce7bc39ed6a1bc457b30825f0459341c236f2dd81ee2323841d10a056a9a826be789aec7eda4cbe1548dd20c0fec4769415b04032a5c84d385e1647a01f7a925912900a084b1fc108c53773ca7a5b30f4960ea6c80db4b9e60dfc740a80a0044d9409956d388d27a8126cebc2062a0faae7fa098f1555b34afda6432a7265a0563b3afe458d08650b7dccb309e74327867995c8d6a3cd421f14056a5d6c5f97a03f5e04b87a9ec990bf1bd560859ed7a855397b7b9564680145142f387f5e0682a0fa941e268271c079d062296b3aad3aeb3f39ffdc2b018e402d7279d2faac2ebf80a07f86879afebf5cdbd10245b2987937a06a00cd5fb26ee34721d591848422c139a0f9e4eb9b7291d621026626edbd005e3124d6cd73907005a1e243f22fd2d0d8bda0ff5098b48edcf8846ad19676040dffa1cb50e9da2ed42f4f2d6468c2cfd3a98da0f9cd8aaf6e6c25015ec950bca83af353907d9b3547b08f3bf0b475e4cc504a2580";
        accountStateProof[3] = hex"e21fa024e9e1b5b3a61e5f5d224bfd4b6ee95db07b7a608fd9b194c4406bb752c82cf6";
        accountStateProof[4] = hex"f8518080808080a0a1378c01041bc4e11a68b3801b9d491a85a8914f068598f0b6ee8b1595ed9c61808080808080808080a02e8ac10e616349023320a3901ba263b3e33726c649120dac5e7bbf80d373691280";
        accountStateProof[5] = hex"f8709e37e1e71c9c46dc97094c22ea738a1031da71127155b3a505d4a0e784bb97b84ff84d80891b1ae4d6e2ef500000a056e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470";
        
        bytes memory blockHeaderRLP = hex"f90214a00000000000000000000000000000000000000000000000000000000000000000a01dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347940000000000000000000000000000000000000000a0d7f8974fb5ac78d9ac099b9ad5018bedc2ce0a72dad1827a1709da30580f0544a056e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421a056e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421b9010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000850400000000808213888080a011bbe8db4e347b4e8c937c1c8370e4b5ed33adb3db69cbdb7a38e1e50b1b82faa00000000000000000000000000000000000000000000000000000000000000000880000000000000042";

        uint256 bal = wrapper.getProvenAccountBalance(
            accountStateProof,
            blockHeaderRLP,
            0xd4e56740f876aef8c010b86a40d5f56745a118d0906a34e69aec8c0db1cb8fa3,
            0xC9c7aC0bdD9342b5ead4360923F68C72a6Ba633A
        );
        assertEq(bal, 500000000000000000000);
    }

    function testExtensionNode3() external {
        bytes[] memory accountStateProof = new bytes[](6);
        accountStateProof[0] = hex"f90211a090dcaf88c40c7bbc95a912cbdde67c175767b31173df9ee4b0d733bfdd511c43a0babe369f6b12092f49181ae04ca173fb68d1a5456f18d20fa32cba73954052bda0473ecf8a7e36a829e75039a3b055e51b8332cbf03324ab4af2066bbd6fbf0021a0bbda34753d7aa6c38e603f360244e8f59611921d9e1f128372fec0d586d4f9e0a04e44caecff45c9891f74f6a2156735886eedf6f1a733628ebc802ec79d844648a0a5f3f2f7542148c973977c8a1e154c4300fec92f755f7846f1b734d3ab1d90e7a0e823850f50bf72baae9d1733a36a444ab65d0a6faaba404f0583ce0ca4dad92da0f7a00cbe7d4b30b11faea3ae61b7f1f2b315b61d9f6bd68bfe587ad0eeceb721a07117ef9fc932f1a88e908eaead8565c19b5645dc9e5b1b6e841c5edbdfd71681a069eb2de283f32c11f859d7bcf93da23990d3e662935ed4d6b39ce3673ec84472a0203d26456312bbc4da5cd293b75b840fc5045e493d6f904d180823ec22bfed8ea09287b5c21f2254af4e64fca76acc5cd87399c7f1ede818db4326c98ce2dc2208a06fc2d754e304c48ce6a517753c62b1a9c1d5925b89707486d7fc08919e0a94eca07b1c54f15e299bd58bdfef9741538c7828b5d7d11a489f9c20d052b3471df475a051f9dd3739a927c89e357580a4c97b40234aa01ed3d5e0390dc982a7975880a0a089d613f26159af43616fd9455bb461f4869bfede26f2130835ed067a8b967bfb80";
        accountStateProof[1] = hex"f90211a054af8fffbda89ebd06c8d3ad48fc748f8d223fc95c48321cdb2190f078637537a0746a8224bfcd8dd6121fa5728a556838847dec9270092d0bc1f6eb8475cb0765a0c0d61f0505ea155e923e7e3265518503f646fa910ad5e3968db91c790b5fe6e3a0ca3b88059233c7b5383f1361f36d2783b17b438176dcb9f8e1c467fb975524a2a0952bdc6c39f70ea3006c2851e77b10aed1814c954aece3d062300ab6c4672a52a041420f5c12a91ec507eeb849ce4063d660e2469cf012e730a32da51257d77c6da035caa6c74300beeff072efbc27e26928c7039316f8ecd7b8342288db2fd4cc55a09b5bfd282968fd9f67f15d49a839412e51532db6bb3257d9e61a73fda73d9440a03917cdf28733c54712a715722dea7926f789a070539c0f56f7fcb66253a567cfa0d848fd76fcbf0c1c1d678e3745230b3df2cee933ca150f304cc90218c3ff6338a06b3a56e8cb60c443d4427b58c4cb374496fd53af347c778c392fe12d8e3e632ca0ccd6020af4f5271bd12306794e36fd2e70e8a8fea34696d74de65b764adac051a00e9cbb831a68520829c75878ded6f3dfe971a28b4b3329a1e2cc4364c95845e5a01516362a5b5163979d6689c2928a9e9fc39390a5fe5086deddd512528b3d0c14a09f10d455a462df6ba9c7f0d81074e21732e433203267e1917bb2ec53f8c47e7ea095ce55f003620d985e23520aa4ce306234f74675bbb45b6e289151815c8ba20d80";
        accountStateProof[2] = hex"f90211a0c6dfe26d053c6d43b656f5375b7a7e6ea39ed6ca12095620864321e0a5cb40a8a02257afc48c1c63f260185876e7cbe3523f436d747c551d68edfc4ae578a1db2aa0d7ef79f4ef922395cc47e3e5fd3fe1ba3573d127067965045dab1e1396f336cba070520fb5be7f9f0d903a0bd3eaaf7da43c17a436aca8222ee599ef73957d0e2ca0c62ace986379b826372f66d7ebc4db8fec2cfff4fa59f21efa1bfeb468f91547a0d5e7c409bcbf6c89873a663041873c72761ed363748375536aff332eea500659a06c8716fadd489d94a1a66f4f5abc3211cd59b66eddd278e37b0367943a44297ba0d7a9099f27a10f546fc25aaa2c21bcb594e77ba1daa989d203e30e412f56862ca0bee0ddd7bf1799f4942aa5d211eece74a14c3da8cd3db90b8d3d24acf6eb479aa04f40db42aab36ebd675170545058e85fd9cd1fae6e215641c48c634aa94b0559a007268443195325ac74b04a9291bd6a996af5aff99a1c09957b101c12ed77d35ea04d8e5c08640e4276adb4037d7627f14c2b478a9349b8e441d320b0e64e0a4905a03c9a26cae6a8a61a3a4db3f20e47d2259d480bd0b4f01e972fc74fda3f76327aa012d0a05aa1454080c905c4fdca1e55cb1b2ccb7d1e248ca9c7ea9d5009df936ba097f051e6c8c5bb0cdc802a0b76c4a1ea93f4be9fe13d6aedf65e3d34c3722e80a07d0713288fd439bbaadf0b4008b16677385d258a1bcfa43a8eff8d9cfe3e4fc280";
        accountStateProof[3] = hex"e21ba037feb6ca0fe2cd0e9ee907287d1d9d1ba54905b1be5104a4ab8633a43fbfa30b";
        accountStateProof[4] = hex"f85180808080a053ec9c2025cdfd334b52db9623c015ba8cc7e508278609117d482fc1cb03097180808080808080a022f6367ea0e7b62d3c0199f98156cb48de16320ac2218c54014be01085f473e180808080";
        accountStateProof[5] = hex"f8709e3069ccd164d99030a84c8c05bd43541d09612fe775efa6f0d82a01b7d8f9b84ff84d80890d8d726b7177a80000a056e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421a0c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470";
        
        bytes memory blockHeaderRLP = hex"f90214a00000000000000000000000000000000000000000000000000000000000000000a01dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347940000000000000000000000000000000000000000a0d7f8974fb5ac78d9ac099b9ad5018bedc2ce0a72dad1827a1709da30580f0544a056e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421a056e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421b9010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000850400000000808213888080a011bbe8db4e347b4e8c937c1c8370e4b5ed33adb3db69cbdb7a38e1e50b1b82faa00000000000000000000000000000000000000000000000000000000000000000880000000000000042";

        uint256 bal = wrapper.getProvenAccountBalance(
            accountStateProof,
            blockHeaderRLP,
            0xd4e56740f876aef8c010b86a40d5f56745a118d0906a34e69aec8c0db1cb8fa3,
            0xc0cA3277942e7445874bE31CEB902972714f1823
        );
        assertEq(bal, 250000000000000000000);
    }
}